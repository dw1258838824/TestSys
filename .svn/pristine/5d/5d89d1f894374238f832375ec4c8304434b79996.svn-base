package com.ruoyi.project.system.api.controller;

import java.io.IOException;
import java.util.Map;

import com.ruoyi.common.constant.Anonymous;
import com.ruoyi.project.system.api.service.WeChatService;
import org.apache.commons.collections.map.HashedMap;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import javax.servlet.http.HttpServletResponse;

@RestController
@RequestMapping("/api/wechat")
public class WeChatApi {

	@Autowired
	private WeChatService weChatService;

	public Map<String,Object> config(){
		Map<String,Object> restMap = new HashedMap();
		return null;
	}

	@GetMapping("/login")
	@Anonymous
	public void login(HttpServletResponse response) throws IOException {
		response.sendRedirect(weChatService.login());
	}

    @GetMapping("/loginCallBack")
	@Anonymous
	public void LoginCallBack(String code, String state,HttpServletResponse response) throws IOException{
		boolean bool = weChatService.getWeChatUserInfo(code);
		if(bool){
			response.sendRedirect("https://www.aliyun.com");
		}else{
			response.sendRedirect("https://www.baidu.com");
		}
    }
}
